{"_path":"/original/getting_started","_dir":"original","_draft":false,"_partial":false,"_locale":"","title":"Getting started with the moteus controller","description":"Binary versions of tview and moteus_tool can be installed for most\nplatforms (desktop Linux, Windows, Mac) via python using the\nmoteus_gui package.","body":{"type":"root","children":[{"type":"element","tag":"h1","props":{"id":"getting-started-with-the-moteus-controller"},"children":[{"type":"text","value":"Getting started with the moteus controller"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Binary versions of "},{"type":"element","tag":"code","props":{"className":""},"children":[{"type":"text","value":"tview"}]},{"type":"text","value":" and "},{"type":"element","tag":"code","props":{"className":""},"children":[{"type":"text","value":"moteus_tool"}]},{"type":"text","value":" can be installed for most\nplatforms (desktop Linux, Windows, Mac) via python using the\n"},{"type":"element","tag":"code","props":{"className":""},"children":[{"type":"text","value":"moteus_gui"}]},{"type":"text","value":" package."}]},{"type":"element","tag":"pre","props":{"className":"language-sh shiki shiki-themes github-dark github-light","code":"pip3 install moteus_gui\n","language":"sh","meta":"","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-dark:#B392F0;--shiki-default:#6F42C1"},"children":[{"type":"text","value":"pip3"}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#9ECBFF;--shiki-default:#032F62"},"children":[{"type":"text","value":" install"}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#9ECBFF;--shiki-default:#032F62"},"children":[{"type":"text","value":" moteus_gui\n"}]}]}]}]},{"type":"element","tag":"h1","props":{"id":"platform-specific-requirements"},"children":[{"type":"text","value":"Platform Specific Requirements"}]},{"type":"element","tag":"h2","props":{"id":"raspberry-pi"},"children":[{"type":"text","value":"Raspberry Pi"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"If you have a Raspberry Pi, see the "},{"type":"element","tag":"a","props":{"href":"raspberry_pi"},"children":[{"type":"text","value":"instructions here"}]},{"type":"text","value":"."}]},{"type":"element","tag":"h2","props":{"id":"linux"},"children":[{"type":"text","value":"Linux"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"If using the fdcanusb, you will need to have udev rules set up in order for regular users to access the device.  Follow the instructions at: "},{"type":"element","tag":"a","props":{"href":"https://github.com/mjbots/fdcanusb/blob/master/70-fdcanusb.rules","rel":["nofollow"]},"children":[{"type":"text","value":"https://github.com/mjbots/fdcanusb/blob/master/70-fdcanusb.rules"}]}]},{"type":"element","tag":"h2","props":{"id":"windows"},"children":[{"type":"text","value":"Windows"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"On some modern Windows installations, you need to invoke python as "},{"type":"element","tag":"code","props":{"className":""},"children":[{"type":"text","value":"python"}]},{"type":"text","value":", not "},{"type":"element","tag":"code","props":{"className":""},"children":[{"type":"text","value":"python3"}]},{"type":"text","value":"."}]},{"type":"element","tag":"h1","props":{"id":"running-tview"},"children":[{"type":"text","value":"Running tview"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"tview lets you configure and inspect the state of the controller.  It\ncan be run like:"}]},{"type":"element","tag":"pre","props":{"className":"language-sh shiki shiki-themes github-dark github-light","code":"python3 -m moteus_gui.tview --devices=1\n","language":"sh","meta":"","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-dark:#B392F0;--shiki-default:#6F42C1"},"children":[{"type":"text","value":"python3"}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#79B8FF;--shiki-default:#005CC5"},"children":[{"type":"text","value":" -m"}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#9ECBFF;--shiki-default:#032F62"},"children":[{"type":"text","value":" moteus_gui.tview"}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#79B8FF;--shiki-default:#005CC5"},"children":[{"type":"text","value":" --devices=1\n"}]}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"(Your pip may have installed a "},{"type":"element","tag":"code","props":{"className":""},"children":[{"type":"text","value":"tview"}]},{"type":"text","value":" script into your path which you\ncould also use)."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"By default, it attempts to detect an attached fdcanusb to communicate\nwith the target."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"tview has three panes, left, right, and bottom.  Further, the left\npane has two tabs."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Left pane, right tab (the default) shows a hierarchical tree of all\ntelemetry items."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Left pane, left tab shows a hierarchical tree of all configurable\nparameters.  Parameter values can be updated by double clicking on\ntheir value and entering a new one."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"The right pane shows real time plots of telemetry items.  It can be\npopulated with plots by right clicking on telemetry items in the\ntelemetry tab."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"The bottom pane has a command line console which shows the commands\nsent internally by tview and their responses, and provides an\ninteractive console to interact with the device using the diagnostic\nprotocol."}]},{"type":"element","tag":"h1","props":{"id":"how-position-mode-works"},"children":[{"type":"text","value":"How position mode works"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"The primary control mode for the moteus controller is an integrated\nposition/velocity controller.  The semantics of the control command\nare somewhat unorthodox, so as to be easily amenable to idempotent\ncommands sent from a higher level controller.  Each command looks\nlike:"}]},{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Position: The desired position in revolutions"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Velocity: The rate at which the desired position changes in\nrevolutions / s"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Maximum torque: Never use more than this amount of torque when controlling"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Feedforward torque: Give this much extra torque beyond what the\nnormal control loop says"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Stop position: If non-special, never move the desired position away\nfrom this target."}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"kp scale: Scale the proportional constant by this factor"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"kd scale: Scale the derivative constant by this factor"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Velocity limit override: If non-special, override the configured\nvelocity limit, which constrains how quickly the target position is\nreached."}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Acceleration limit override: If non-special, override the\nconfigured acceleration limit, which constrains how quickly the\ntarget position is reached."}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Additionally, the position may be set as a \"special value\" (NaN for\nfloating point and the debug interface, maximal negative for integer\nencodings).  In that case, the position selected is \"wherever you are\nright now\"."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"A pure velocity mode can be obtained by setting the kp scale to 0 (or\npermanently so by configuring the kp constant to 0).  In this case,\nusing the "},{"type":"element","tag":"code","props":{"className":""},"children":[{"type":"text","value":"servo.max_position_slip"}]},{"type":"text","value":" configurable parameter may be\nvaluable as per the "},{"type":"element","tag":"a","props":{"href":"reference#velocity-control"},"children":[{"type":"text","value":"reference manual"}]},{"type":"text","value":"."}]},{"type":"element","tag":"h1","props":{"id":"initial-configuration"},"children":[{"type":"text","value":"Initial Configuration"}]},{"type":"element","tag":"h2","props":{"id":"important-note-on-electrical-damage"},"children":[{"type":"text","value":"IMPORTANT NOTE ON ELECTRICAL DAMAGE"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"moteus uses moderately large currents and moderately high voltages.  It is important to take many factors in consideration when deploying it to avoid electrical damage to the controller.  Before soldering cables, or attaching moteus to a new motor, be sure to read and understand each of the following sections in the reference manual:"}]},{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"a","props":{"href":"reference#phase-wire-soldering"},"children":[{"type":"text","value":"Phase Wire Soldering"}]}]},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"a","props":{"href":"reference#power-cable-construction"},"children":[{"type":"text","value":"Cable Construction"}]}]},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"a","props":{"href":"reference#power-connectorization"},"children":[{"type":"text","value":"Power Connectorization"}]}]},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"a","props":{"href":"reference#regenerative-braking-safety"},"children":[{"type":"text","value":"Regenerative Braking Safety"}]}]}]},{"type":"element","tag":"h2","props":{"id":"parameters"},"children":[{"type":"text","value":"Parameters"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"There are a few parameters you will likely want to configure early on\nin your setup regardless:"}]},{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"code","props":{"className":""},"children":[{"type":"text","value":"servopos.position_min"}]},{"type":"text","value":" and "},{"type":"element","tag":"code","props":{"className":""},"children":[{"type":"text","value":"servopos.position_max"}]},{"type":"text","value":" these define the bounds of motion which the controller will allow when in position control mode.  Attempting to start beyond this region will fault, and if outside the region in operation, no torque will be applied to go further outside."}]},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"code","props":{"className":""},"children":[{"type":"text","value":"servo.max_current_A"}]},{"type":"text","value":" the maximum phase current to apply to the motor.  This can be used to limit the maximum torque that the system is capable of regardless of any command sent."}]},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"code","props":{"className":""},"children":[{"type":"text","value":"servo.default_velocity_limit"}]},{"type":"text","value":" / "},{"type":"element","tag":"code","props":{"className":""},"children":[{"type":"text","value":"servo.default_accel_limit"}]},{"type":"text","value":" controls how fast the motor can accelerate and spin in order to reach position and velocity targets.  Bare boards ship with these unset, while development kits ship with human-eye pleasing values."}]},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"code","props":{"className":""},"children":[{"type":"text","value":"servo.pid_position"}]},{"type":"text","value":" the PID parameters for the position control loop."}]},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"code","props":{"className":""},"children":[{"type":"text","value":"motor_position.rotor_to_output_ratio"}]},{"type":"text","value":" any gearbox scaling, a reducing gearbox should be configured with a number smaller than one, e.g. 0.25 for a 4x reduction gearbox.  This affects reported position, speed, and torques."}]},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"code","props":{"className":""},"children":[{"type":"text","value":"id.id"}]},{"type":"text","value":" the CAN-FD id used by this device"}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"A larger set of parameters is documented in the reference manual."}]},{"type":"element","tag":"h2","props":{"id":"calibration"},"children":[{"type":"text","value":"Calibration"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"If you started from a bare moteus board, you will need to calibrate it\nfor the attached motor before any control modes are possible."}]},{"type":"element","tag":"pre","props":{"className":"language-sh shiki shiki-themes github-dark github-light","code":"python3 -m moteus.moteus_tool --target 1 --calibrate\n","language":"sh","meta":"","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-dark:#B392F0;--shiki-default:#6F42C1"},"children":[{"type":"text","value":"python3"}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#79B8FF;--shiki-default:#005CC5"},"children":[{"type":"text","value":" -m"}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#9ECBFF;--shiki-default:#032F62"},"children":[{"type":"text","value":" moteus.moteus_tool"}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#79B8FF;--shiki-default:#005CC5"},"children":[{"type":"text","value":" --target"}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#79B8FF;--shiki-default:#005CC5"},"children":[{"type":"text","value":" 1"}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#79B8FF;--shiki-default:#005CC5"},"children":[{"type":"text","value":" --calibrate\n"}]}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"WARNING: Any attached motor must be able to spin freely.  It will be\nspun in both directions and at high speed."}]},{"type":"element","tag":"h1","props":{"id":"learning-more"},"children":[{"type":"text","value":"Learning more"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"The complete reference documentation can be found at:\n"},{"type":"element","tag":"a","props":{"href":"reference"},"children":[{"type":"text","value":"Reference"}]}]},{"type":"element","tag":"style","props":{},"children":[{"type":"text","value":"html .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html.dark .shiki span {color: var(--shiki-dark);background: var(--shiki-dark-bg);font-style: var(--shiki-dark-font-style);font-weight: var(--shiki-dark-font-weight);text-decoration: var(--shiki-dark-text-decoration);}html .dark .shiki span {color: var(--shiki-dark);background: var(--shiki-dark-bg);font-style: var(--shiki-dark-font-style);font-weight: var(--shiki-dark-font-weight);text-decoration: var(--shiki-dark-text-decoration);}html .default .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}"}]}],"toc":{"title":"","searchDepth":2,"depth":2,"links":[{"id":"raspberry-pi","depth":2,"text":"Raspberry Pi"},{"id":"linux","depth":2,"text":"Linux"},{"id":"windows","depth":2,"text":"Windows"},{"id":"important-note-on-electrical-damage","depth":2,"text":"IMPORTANT NOTE ON ELECTRICAL DAMAGE"},{"id":"parameters","depth":2,"text":"Parameters"},{"id":"calibration","depth":2,"text":"Calibration"}]}},"_type":"markdown","_id":"content:1.original:1.getting_started.md","_source":"content","_file":"1.original/1.getting_started.md","_extension":"md"}